<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard - Metrolinx Book Exchange</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link th:href="@{/css/style.css}" rel="stylesheet">
</head>
<body>
    <!-- Enhanced Navigation -->
    <nav class="navbar navbar-expand-lg navbar-dark">
        <div class="container">
            <a class="navbar-brand" th:href="@{/dashboard}">
                <i class="fas fa-book-exchange"></i> Metrolinx Book Exchange
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav me-auto">
                    <li class="nav-item">
                        <a class="nav-link active" th:href="@{/dashboard}">
                            <i class="fas fa-tachometer-alt"></i> Dashboard
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" th:href="@{/books}">
                            <i class="fas fa-book"></i> Books
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" th:href="@{/members}">
                            <i class="fas fa-users"></i> Members
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" th:href="@{/exchanges}">
                            <i class="fas fa-exchange-alt"></i> Exchanges
                        </a>
                    </li>
                </ul>
                
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item">
                        <form th:action="@{/logout}" method="post" class="d-inline">
                            <button type="submit" class="btn btn-link nav-link text-light p-0 border-0">
                                <i class="fas fa-sign-out-alt"></i> Logout
                            </button>
                        </form>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

	<!-- Page Header -->
	<div class="page-header">
	    <div class="container">
	        <div class="row align-items-center">
	            <div class="col-md-8">
	                <h1 class="page-title">Dashboard Overview</h1>
	                <p class="page-subtitle">Welcome to Metrolinx Book Exchange Management System</p>
	            </div>
	            <div class="col-md-4 text-end">
	                <!-- Single Add Book Button - Removed redundancy -->
	                <a th:href="@{/books/add}" class="btn btn-light btn-lg">
	                    <i class="fas fa-plus-circle"></i> Add New Book
	                </a>
	            </div>
	        </div>
	    </div>
	</div>

	<!-- Main Content -->
	<div class="container">
	    <!-- Flash Messages -->
	    <div th:if="${success}" class="alert alert-success alert-dismissible fade show">
	        <span th:text="${success}"></span>
	        <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
	    </div>
	    <div th:if="${error}" class="alert alert-danger alert-dismissible fade show">
	        <span th:text="${error}"></span>
	        <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
	    </div>

		<!-- Statistics Grid - Single Row -->
		<div class="row mb-5">
		    <div class="col-xl-3 col-md-6 mb-4">
		        <div class="stat-card-enhanced">
		            <div class="stat-icon">
		                <i class="fas fa-book"></i>
		            </div>
		            <div class="stat-number" th:text="${totalBooks}">0</div>
		            <div class="stat-label">Total Books</div>
		        </div>
		    </div>
		    
		    <div class="col-xl-3 col-md-6 mb-4">
		        <div class="stat-card-enhanced" style="background: linear-gradient(135deg, #10b981, #059669);">
		            <div class="stat-icon">
		                <i class="fas fa-users"></i>
		            </div>
		            <div class="stat-number" th:text="${activeMembers}">0</div>
		            <div class="stat-label">Active Members</div>
		        </div>
		    </div>
		    
		    <div class="col-xl-3 col-md-6 mb-4">
		        <div class="stat-card-enhanced" style="background: linear-gradient(135deg, #f59e0b, #d97706);">
		            <div class="stat-icon">
		                <i class="fas fa-clock"></i>
		            </div>
		            <div class="stat-number" th:text="${pendingRequests}">0</div>
		            <div class="stat-label">Pending Requests</div>
		        </div>
		    </div>
		    
		    <div class="col-xl-3 col-md-6 mb-4">
		        <div class="stat-card-enhanced" style="background: linear-gradient(135deg, #ef4444, #dc2626);">
		            <div class="stat-icon">
		                <i class="fas fa-exclamation-triangle"></i>
		            </div>
		            <div class="stat-number" th:text="${overdueBooks}">0</div>
		            <div class="stat-label">Overdue Books</div>
		        </div>
		    </div>
		</div>

	    <!-- Quick Actions - Redesigned -->
	    <div class="modern-form mb-4">
	        <div class="form-section">
	            <h4 class="mb-4"><i class="fas fa-bolt text-warning me-2"></i>Quick Actions</h4>
	            
	            <div class="quick-actions-grid">
	                <a th:href="@{/books}" class="quick-action-card">
	                    <i class="fas fa-search"></i>
	                    <div class="action-text">Browse Books</div>
	                    <small class="action-subtext">Explore available books</small>
	                </a>
	                
	                <a th:href="@{/members}" class="quick-action-card" style="background: linear-gradient(135deg, #10b981, #059669);">
	                    <i class="fas fa-user-friends"></i>
	                    <div class="action-text">Manage Members</div>
	                    <small class="action-subtext">View all members</small>
	                </a>
	                
	                <a th:href="@{/exchanges}" class="quick-action-card" style="background: linear-gradient(135deg, #8b5cf6, #7c3aed);">
	                    <i class="fas fa-history"></i>
	                    <div class="action-text">Exchange History</div>
	                    <small class="action-subtext">Track all exchanges</small>
	                </a>
	                
	                <!-- Future Admin Only - Commented for now -->
	                <!-- 
	                <a th:href="@{/members/add}" class="quick-action-card" style="background: linear-gradient(135deg, #f59e0b, #d97706);">
	                    <i class="fas fa-user-plus"></i>
	                    <div class="action-text">Add Member</div>
	                    <small class="action-subtext">Admin only</small>
	                </a>
	                -->
	            </div>
	        </div>
	    </div>

	    <!-- Recent Activity Section -->
	    <div class="row">
	        <div class="col-lg-6">
	            <div class="modern-form">
	                <div class="form-section">
	                    <h5 class="mb-4"><i class="fas fa-clock text-info me-2"></i>Recent Books</h5>
	                    
	                    <div th:if="${recentBooks.empty}" class="text-center text-muted py-3">
	                        <i class="fas fa-book fa-2x mb-2 opacity-25"></i>
	                        <p class="mb-0">No recent books added</p>
	                    </div>
	                    
	                    <div th:unless="${recentBooks.empty}" class="recent-items">
	                        <div th:each="book, status : ${recentBooks}" th:if="${status.index < 5}" class="recent-item">
	                            <div class="d-flex align-items-center">
	                                <div class="flex-shrink-0">
	                                    <i class="fas fa-book text-primary"></i>
	                                </div>
	                                <div class="flex-grow-1 ms-3">
	                                    <h6 class="mb-1" th:text="${book.title}">Book Title</h6>
	                                    <small class="text-muted" th:text="${book.author}">Author</small>
	                                </div>
	                                <div class="flex-shrink-0">
	                                    <span th:if="${book.available}" class="badge bg-success">Available</span>
	                                    <span th:unless="${book.available}" class="badge bg-secondary">Unavailable</span>
	                                </div>
	                            </div>
	                        </div>
	                    </div>
	                    
	                    <div class="text-center mt-3">
	                        <a th:href="@{/books}" class="btn btn-outline-primary btn-sm">
	                            View All Books
	                        </a>
	                    </div>
	                </div>
	            </div>
	        </div>
	        
	        <div class="col-lg-6">
	            <div class="modern-form">
	                <div class="form-section">
	                    <h5 class="mb-4"><i class="fas fa-bell text-warning me-2"></i>Pending Actions</h5>
	                    
	                    <div th:if="${pendingRequests == 0}" class="text-center text-muted py-3">
	                        <i class="fas fa-check-circle fa-2x mb-2 text-success"></i>
	                        <p class="mb-0">No pending actions</p>
	                    </div>
	                    
	                    <div th:unless="${pendingRequests == 0}" class="pending-actions">
	                        <div class="pending-item">
	                            <div class="d-flex align-items-center">
	                                <div class="flex-shrink-0">
	                                    <i class="fas fa-exchange-alt text-warning"></i>
	                                </div>
	                                <div class="flex-grow-1 ms-3">
	                                    <h6 class="mb-1" th:text="${pendingRequests + ' Pending Requests'}">Pending Requests</h6>
	                                    <small class="text-muted">Book exchange requests awaiting approval</small>
	                                </div>
	                                <div class="flex-shrink-0">
	                                    <a th:href="@{/exchanges/pending}" class="btn btn-warning btn-sm">
	                                        Review
	                                    </a>
	                                </div>
	                            </div>
	                        </div>
	                        
	                        <div th:if="${overdueBooks > 0}" class="pending-item mt-3">
	                            <div class="d-flex align-items-center">
	                                <div class="flex-shrink-0">
	                                    <i class="fas fa-exclamation-triangle text-danger"></i>
	                                </div>
	                                <div class="flex-grow-1 ms-3">
	                                    <h6 class="mb-1" th:text="${overdueBooks + ' Overdue Books'}">Overdue Books</h4>
	                                    <small class="text-muted">Books that need to be returned</small>
	                                </div>
	                                <div class="flex-shrink-0">
	                                    <a th:href="@{/exchanges/borrowed}" class="btn btn-danger btn-sm">
	                                        View
	                                    </a>
	                                </div>
	                            </div>
	                        </div>
	                    </div>
	                </div>
	            </div>
	        </div>
	    </div>
	</div>

	<!-- Footer -->
	<footer class="mt-5 py-4">
	    <div class="container text-center">
	        <p class="mb-0 text-white">&copy; 2025 Metrolinx Book Exchange System. Enterprise Edition v2.0</p>
	    </div>
	</footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>